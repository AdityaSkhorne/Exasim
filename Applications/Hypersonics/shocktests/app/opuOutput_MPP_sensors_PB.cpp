template <typename T> void opuOutput(T *f, T *xdg, T *udg, T *odg, T *wdg, T *uinf, T *param, T time, int modelnumber, int ng, int nc, int ncu, int nd, int ncx, int nco, int ncw, int nce, int npe, int ne, Mutation::Mixture *mix)
{
    double Uwork[5];
    double dTdU[6];
    int nspecies = 5;
    int ndim = 1;
    double rho_scale = uinf[0];
    double u_scale = uinf[1];
    double rhoe_scale = uinf[2];
	for (int i = 0; i <ng; i++) {
		int j = i%npe;
		int k = (i-j)/npe;
		T param1 = param[0];
		T param2 = param[1];
		T param3 = param[2];
		T param4 = param[3];
		T param5 = param[4];
		T param15 = param[14];
		T param16 = param[15];
		T param17 = param[16];
		T param18 = param[17];
		T uinf1 = uinf[0];
		T uinf2 = uinf[1];
		T uinf3 = uinf[2];
		T xdg1 = xdg[j+npe*0+npe*ncx*k];
		T udg1 = udg[j+npe*0+npe*nc*k];
		T udg2 = udg[j+npe*1+npe*nc*k];
		T udg3 = udg[j+npe*2+npe*nc*k];
		T udg4 = udg[j+npe*3+npe*nc*k];
		T udg5 = udg[j+npe*4+npe*nc*k];
		T udg6 = udg[j+npe*5+npe*nc*k];
		T udg7 = udg[j+npe*6+npe*nc*k];
		T udg8 = udg[j+npe*7+npe*nc*k];
		T udg9 = udg[j+npe*8+npe*nc*k];
		T udg10 = udg[j+npe*9+npe*nc*k];
		T udg11 = udg[j+npe*10+npe*nc*k];
		T udg12 = udg[j+npe*11+npe*nc*k];
		T udg13 = udg[j+npe*12+npe*nc*k];
		T udg14 = udg[j+npe*13+npe*nc*k];
		T odg1 = odg[j+npe*0+npe*nco*k];
		T odg2 = odg[j+npe*1+npe*nco*k];
		T odg3 = odg[j+npe*2+npe*nco*k];
		T odg4 = odg[j+npe*3+npe*nco*k];
		T odg5 = odg[j+npe*4+npe*nco*k];
		T odg6 = odg[j+npe*5+npe*nco*k];
		T odg7 = odg[j+npe*6+npe*nco*k];
		T odg8 = odg[j+npe*7+npe*nco*k];
		T odg9 = odg[j+npe*8+npe*nco*k];

        T t1pi = 1.0/3.141592653589793;
		udg1 = udg1*(t1pi*atan(udg1*1.0E+12)+1.0/2.0)+3.182454300088011e-13;
		udg2 = udg2*(t1pi*atan(udg2*1.0E+12)+1.0/2.0)+3.182454300088011e-13;
		udg3 = udg3*(t1pi*atan(udg3*1.0E+12)+1.0/2.0)+3.182454300088011e-13;
		udg4 = udg4*(t1pi*atan(udg4*1.0E+12)+1.0/2.0)+3.182454300088011e-13;
		udg5 = udg5*(t1pi*atan(udg5*1.0E+12)+1.0/2.0)+3.182454300088011e-13;

		int nspecies = 5;
		double rho_scale = uinf[0];
		double u_scale = uinf[1];
		double rhoe_scale = uinf[2];

		double Ucons[7] = {udg1, udg2, udg3, udg4, udg5, udg6, udg7};
		double Ustate[6];
		dimensionalizeConsVars(Ucons, (double*)uinf, nspecies, 1);
		conservativeToState(Ucons, Ustate, (double*)uinf, nspecies, 1);
		double rhovec[5] = {Ustate[0],Ustate[1],Ustate[2],Ustate[3],Ustate[4]};
		double rhoe = Ustate[nspecies];
		mix->setState(rhovec, &rhoe, 0);

		uinf1 = mix->P()/rhoe_scale; // pressure
		uinf2 = mix->mixtureFrozenGamma(); // gamma
        uinf3 = (mix->frozenThermalConductivity() / uinf[5]) / (mix->viscosity() / uinf[4]); // cp / Pr^*
        // uinf3 = 0.0;
        // uinf3 = 1.0/0.9;


		T t2 = udg6*udg6;
		T t3 = uinf2*2.0;
		T t4 = uinf2+1.0;
		T t5 = 1.0/3.141592653589793;
		T t6 = -param18;
		T t7 = 1.0/param1;
		T t8 = 1.0/param2;
		T t9 = 1.0/param3;
		T t10 = 1.0/param4;
		T t11 = 1.0/param5;
		T t12 = 1.0/param15;
		T t15 = udg8+udg9+udg10+udg11+udg12;
		T t16 = param17*1.0E+12;
		T t17 = param18*1.0E+12;
		T t18 = udg1*1.0E+12;
		T t19 = udg2*1.0E+12;
		T t20 = udg3*1.0E+12;
		T t21 = udg4*1.0E+12;
		T t22 = udg5*1.0E+12;
		T t13 = t3-2.0;
		T t14 = 1.0/t4;
		T t23 = atan(t18);
		T t24 = atan(t19);
		T t25 = atan(t20);
		T t26 = atan(t21);
		T t27 = atan(t22);
		T t28 = -t17;
		T t29 = t5*t23;
		T t30 = t5*t24;
		T t31 = t5*t25;
		T t32 = t5*t26;
		T t33 = t5*t27;
		T t34 = t29+1.0/2.0;
		T t35 = t30+1.0/2.0;
		T t36 = t31+1.0/2.0;
		T t37 = t32+1.0/2.0;
		T t38 = t33+1.0/2.0;
		T t39 = t34*udg1;
		T t40 = t35*udg2;
		T t41 = t36*udg3;
		T t42 = t37*udg4;
		T t43 = t38*udg5;
		T t44 = t39+3.182454300088011E-13;
		T t45 = t40+3.182454300088011E-13;
		T t46 = t41+3.182454300088011E-13;
		T t47 = t42+3.182454300088011E-13;
		T t48 = t43+3.182454300088011E-13;
		T t49 = t39+t40+t41+t42+t43+1.591227150044006E-12;
		T t50 = 1.0/t49;
		T t51 = t50*t50;
		T t52 = t50*udg7;
		T t53 = t50*uinf1;
		T t55 = t15*t50*udg6;
		T t60 = t15*t44*t50;
		T t61 = t15*t45*t50;
		T t62 = t15*t46*t50;
		T t63 = t15*t47*t50;
		T t64 = t15*t48*t50;
		T t54 = t2*t51;
		T t56 = -t55;
		T t58 = t52*1.0E+12;
		T t59 = t53*1.0E+12;
		T t65 = -t60;
		T t66 = -t61;
		T t67 = -t62;
		T t68 = -t63;
		T t69 = -t64;
		T t75 = -t50*(t55-udg13);
		T t76 = t52+t53-1.0E-4;
		T t78 = t50*(t55-udg13)*-1.0E+12;
		T t87 = odg9*t7*t12*t50*(t60-udg8)*(-1.15663130678818E-1);
		T t88 = odg9*t8*t12*t50*(t61-udg9)*(-1.15663130678818E-1);
		T t89 = odg9*t9*t12*t50*(t62-udg10)*(-1.15663130678818E-1);
		T t90 = odg9*t10*t12*t50*(t63-udg11)*(-1.15663130678818E-1);
		T t91 = odg9*t11*t12*t50*(t64-udg12)*(-1.15663130678818E-1);
		T t97 = odg9*t7*t12*t50*(t60-udg8)*(-1.15663130678818E+11);
		T t98 = odg9*t8*t12*t50*(t61-udg9)*(-1.15663130678818E+11);
		T t99 = odg9*t9*t12*t50*(t62-udg10)*(-1.15663130678818E+11);
		T t100 = odg9*t10*t12*t50*(t63-udg11)*(-1.15663130678818E+11);
		T t101 = odg9*t11*t12*t50*(t64-udg12)*(-1.15663130678818E+11);
		T t57 = t56+udg13;
		T t70 = t65+udg8;
		T t71 = t66+udg9;
		T t72 = t67+udg10;
		T t73 = t68+udg11;
		T t74 = t69+udg12;
		T t77 = t75-1.0E+4;
		T t79 = t58+t59-1.0E+8;
		T t81 = t78-1.0E+16;
		T t92 = param17+t87;
		T t93 = param17+t88;
		T t94 = param17+t89;
		T t95 = param17+t90;
		T t96 = param17+t91;
		T t102 = t16+t97;
		T t103 = t16+t98;
		T t104 = t16+t99;
		T t105 = t16+t100;
		T t106 = t16+t101;
		T t80 = atan(t79);
		T t82 = atan(t81);
		T t107 = atan(t102);
		T t108 = atan(t103);
		T t109 = atan(t104);
		T t110 = atan(t105);
		T t111 = atan(t106);
		T t83 = t5*t80;
		T t85 = t5*t82;
		T t112 = t5*t107;
		T t113 = t5*t108;
		T t114 = t5*t109;
		T t115 = t5*t110;
		T t116 = t5*t111;
		T t84 = t83+1.0/2.0;
		T t86 = t85-1.0/2.0;
		T t117 = t112-1.0/2.0;
		T t118 = t113-1.0/2.0;
		T t119 = t114-1.0/2.0;
		T t120 = t115-1.0/2.0;
		T t121 = t116-1.0/2.0;
		T t122 = t76*t84;
		T t123 = -t86*(t50*(t55-udg13)+1.0E+4);
		T t124 = t86*(t50*(t55-udg13)+1.0E+4);
		T t134 = t92*t117;
		T t135 = t93*t118;
		T t136 = t94*t119;
		T t137 = t95*t120;
		T t138 = t96*t121;
		T t125 = t124*-1.0E+12;
		T t126 = t122+1.000000003182454E-4;
		T t128 = t123-2.0E+4;
		T t127 = t13*t14*t126;
		T t130 = t125-2.0E+16;
		T t129 = 1.0/sqrt(t127);
		T t131 = atan(t130);
		T t139 = t54+t127;
		T t132 = t5*t131;
		T t140 = sqrt(t139);
		T t133 = t132+1.0/2.0;
		T t141 = -t133*(t124+2.0E+4);
		T t142 = t124+t141+1.0E+4;
		T t143 = odg9*t12*t129*t142;
		T t144 = -t143;
		T t146 = t143*1.0E+12;
		T t145 = param17+t144;
		T t147 = -t146;
		T t148 = t16+t147;
		T t149 = atan(t148);
		T t150 = t5*t149;
		T t151 = t150-1.0/2.0;
		T t152 = t145*t151;
		T t153 = t152*1.0E+12;
		T t154 = t6+t152+3.182454300088011E-13;
		T t155 = t28+t153+3.182454300088011E-1;
		T t156 = atan(t155);
		T t157 = t5*t156;
		T t158 = t157+1.0/2.0;
		T t159 = t154*t158;
		T t160 = -t159;
		T t161 = t152+t160;
		f[j+npe*0+npe*nce*k] = odg9*param16*t12*t49*t140*t161;
		f[j+npe*1+npe*nce*k] = 0.0;
		f[j+npe*2+npe*nce*k] = odg9*param16*t12*t49*t140*t161*uinf3;
		f[j+npe*3+npe*nce*k] = odg9*param16*t12*t49*t140*(t134-(t5*atan(t28+t134*1.0E+12+3.182454300088011E-1)+1.0/2.0)*(t6+t134+3.182454300088011E-13));
		f[j+npe*4+npe*nce*k] = odg9*param16*t12*t49*t140*(t135-(t5*atan(t28+t135*1.0E+12+3.182454300088011E-1)+1.0/2.0)*(t6+t135+3.182454300088011E-13));
		f[j+npe*5+npe*nce*k] = odg9*param16*t12*t49*t140*(t136-(t5*atan(t28+t136*1.0E+12+3.182454300088011E-1)+1.0/2.0)*(t6+t136+3.182454300088011E-13));
		f[j+npe*6+npe*nce*k] = odg9*param16*t12*t49*t140*(t137-(t5*atan(t28+t137*1.0E+12+3.182454300088011E-1)+1.0/2.0)*(t6+t137+3.182454300088011E-13));
		f[j+npe*7+npe*nce*k] = odg9*param16*t12*t49*t140*(t138-(t5*atan(t28+t138*1.0E+12+3.182454300088011E-1)+1.0/2.0)*(t6+t138+3.182454300088011E-13));

	}
}

template void opuOutput(double *, double *, double *, double *, double *, double *, double *, double, int, int, int, int, int, int, int, int, int, int, int, Mutation::Mixture *);
template void opuOutput(float *, float *, float *, float *, float *, float *, float *, float, int, int, int, int, int, int, int, int, int, int, int, Mutation::Mixture *);
